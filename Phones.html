<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPhone Screen Price Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
    <script>
        // Use localStorage to store prices persistently
        function getInitialPrices() {
            const storedPrices = localStorage.getItem('iphonePrices');
            if (storedPrices) {
                try {
                    return JSON.parse(storedPrices);
                } catch (error) {
                    console.error("Error parsing stored prices:", error);
                    // Handle the error, e.g., clear the invalid data
                    localStorage.removeItem('iphonePrices');
                    // Return to default prices
                    return {
                        "iPhone 12": { name: "iPhone 12", price: 15.00 },
                        "iPhone 12 Mini": { name: "iPhone 12 Mini", price: 14.50 },
                        "iPhone 12 Pro": { name: "iPhone 12 Pro", price: 20.00 },
                        "iPhone 12 Pro Max": { name: "iPhone 12 Pro Max", price: 22.00 },
                        "iPhone 13": { name: "iPhone 13", price: 18.00 },
                        "iPhone 13 Mini": { name: "iPhone 13 Mini", price: 17.50 },
                        "iPhone 13 Pro": { name: "iPhone 13 Pro", price: 25.00 },
                        "iPhone 13 Pro Max": { name: "iPhone 13 Pro Max", price: 27.00 },
                        "iPhone 14": { name: "iPhone 14", price: 20.00 },
                        "iPhone 14 Plus": { name: "iPhone 14 Plus", price: 22.00 },
                        "iPhone 14 Pro": { name: "iPhone 14 Pro", price: 30.00 },
                        "iPhone 14 Pro Max": { name: "iPhone 14 Pro Max", price: 32.00 },
                        "iPhone 15": { name: "iPhone 15", price: 25.00 },
                        "iPhone 15 Plus": { name: "iPhone 15 Plus", price: 27.00 },
                        "iPhone 15 Pro": { name: "iPhone 15 Pro", price: 35.00 },
                        "iPhone 15 Pro Max": { name: "iPhone 15 Pro Max", price: 37.00 },
                        "iPhone 16": { name: "iPhone 16", price: 30.00 },
                        "iPhone 16 Plus": { name: "iPhone 16 Plus", price: 32.00 },
                        "iPhone 16 Pro": { name: "iPhone 16 Pro", price: 40.00 },
                        "iPhone 16 Pro Max": { name: "iPhone 16 Pro Max", price: 42.00 },
                    };
                }
            } else {
                // Default prices
                return {
                    "iPhone 12": { name: "iPhone 12", price: 15.00 },
                    "iPhone 12 Mini": { name: "iPhone 12 Mini", price: 14.50 },
                    "iPhone 12 Pro": { name: "iPhone 12 Pro", price: 20.00 },
                    "iPhone 12 Pro Max": { name: "iPhone 12 Pro Max", price: 22.00 },
                    "iPhone 13": { name: "iPhone 13", price: 18.00 },
                    "iPhone 13 Mini": { name: "iPhone 13 Mini", price: 17.50 },
                    "iPhone 13 Pro": { name: "iPhone 13 Pro", price: 25.00 },
                    "iPhone 13 Pro Max": { name: "iPhone 13 Pro Max", price: 27.00 },
                    "iPhone 14": { name: "iPhone 14", price: 20.00 },
                    "iPhone 14 Plus": { name: "iPhone 14 Plus", price: 22.00 },
                    "iPhone 14 Pro": { name: "iPhone 14 Pro", price: 30.00 },
                    "iPhone 14 Pro Max": { name: "iPhone 14 Pro Max", price: 32.00 },
                    "iPhone 15": { name: "iPhone 15", price: 25.00 },
                    "iPhone 15 Plus": { name: "iPhone 15 Plus", price: 27.00 },
                    "iPhone 15 Pro": { name: "iPhone 15 Pro", price: 35.00 },
                    "iPhone 15 Pro Max": { name: "iPhone 15 Pro Max", price: 37.00 },
                    "iPhone 16": { name: "iPhone 16", price: 30.00 },
                    "iPhone 16 Plus": { name: "iPhone 16 Plus", price: 32.00 },
                    "iPhone 16 Pro": { name: "iPhone 16 Pro", price: 40.00 },
                    "iPhone 16 Pro Max": { name: "iPhone 16 Pro Max", price: 42.00 },
                };
            }
        }

        // Function to fetch current price (now just returns stored price)
        function fetchPrice(model) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve(initialPrices[model].price);
                }, 0);
            });
        }

        // Function to update the price on the webpage
        async function updatePrice(model) {
            const priceElementId = `${model.replace(/\s+/g, '')}-price`;
            const priceElement = document.getElementById(priceElementId);
            if (!priceElement) return;

            try {
                const newPrice = await fetchPrice(model);
                priceElement.textContent = `$${newPrice}`;
                // No color change since we're not simulating changes
            } catch (error) {
                console.error(`Failed to update price for ${model}:`, error);
                priceElement.textContent = "Error";
            }
        }

        // Function to update all prices
        async function updateAllPrices() {
            for (const model in initialPrices) {
                await updatePrice(model);
            }
        }

        // Function to create the price table, with input fields
        function createPriceTable(prices) {
            const table = document.createElement("table");
            table.className = "min-w-full divide-y divide-gray-200";

            const thead = document.createElement("thead");
            thead.className = "bg-gray-50";

            const tr = document.createElement("tr");
            const modelHeader = document.createElement("th");
            modelHeader.scope = "col";
            modelHeader.className = "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider";
            modelHeader.textContent = "Model";

            const priceHeader = document.createElement("th");
            priceHeader.scope = "col";
            priceHeader.className = "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider";
            priceHeader.textContent = "Current Price";

            const editHeader = document.createElement("th");
            editHeader.scope = "col";
            editHeader.className = "px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider";
            editHeader.textContent = "Edit Price";

            tr.appendChild(modelHeader);
            tr.appendChild(priceHeader);
            tr.appendChild(editHeader);
            thead.appendChild(tr);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            tbody.className = "bg-white divide-y divide-gray-200";

            for (const model in prices) {
                const modelData = prices[model];
                const row = document.createElement("tr");
                const modelCell = document.createElement("td");
                modelCell.className = "px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900";
                modelCell.textContent = modelData.name;

                const priceCell = document.createElement("td");
                priceCell.className = "px-6 py-4 whitespace-nowrap text-sm text-gray-700";
                priceCell.id = `${model.replace(/\s+/g, '')}-price`;
                priceCell.textContent = `$${modelData.price}`;

                const editCell = document.createElement("td");
                editCell.className = "px-6 py-4 whitespace-nowrap text-sm text-gray-700";
                const input = document.createElement("input");
                input.type = "number";
                input.value = modelData.price;
                input.className = "shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md";
                input.id = `${model.replace(/\s+/g, '')}-input`;

                const saveButton = document.createElement("button");
                saveButton.textContent = "Save";
                saveButton.className = "ml-2 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded";
                saveButton.onclick = function () {
                    const newPrice = parseFloat(document.getElementById(`${model.replace(/\s+/g, '')}-input`).value);
                    if (!isNaN(newPrice)) {
                        initialPrices[model].price = newPrice;
                        updatePrice(model);
                        // Save to localStorage
                        localStorage.setItem('iphonePrices', JSON.stringify(initialPrices));
                        console.log(`Price for ${model} updated to $${newPrice} and saved.`);
                    } else {
                        alert("Invalid price!");
                    }
                };

                editCell.appendChild(input);
                editCell.appendChild(saveButton);

                row.appendChild(modelCell);
                row.appendChild(priceCell);
                row.appendChild(editCell);
                tbody.appendChild(row);
            }

            table.appendChild(tbody);
            return table;
        }

        // Function to initialize the app
        async function initializeApp() {
            const prices = getInitialPrices(); // Load prices from localStorage
            initialPrices = prices; //update the global variable
            const priceTableContainer = document.getElementById("price-table-container");
            const priceTable = createPriceTable(prices);
            priceTableContainer.appendChild(priceTable);

            // Initial update of prices
            await updateAllPrices();
            // No interval needed now, prices are updated manually
        }

        // Event listener for DOMContentLoaded
        document.addEventListener("DOMContentLoaded", initializeApp);
    </script>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-semibold text-gray-800 mb-6 text-center">iPhone Screen Prices from MobileSentrix</h1>
        <div id="price-table-container" class="shadow-md rounded-lg overflow-hidden">
        </div>
        <div class="mt-4 text-sm text-gray-500 text-center">
            <p>Prices are updated manually by you.</p>
            <p>This site is not affiliated with MobileSentrix.</p>
        </div>
    </div>
</body>
</html>
